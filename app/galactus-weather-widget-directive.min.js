/*! galactus-weather-widget-factory 28-11-2016 */
var weatherWidgetModule=angular.module("weatherWidgetModule",[]);weatherWidgetModule.service("weatherService",function(a,b,c,d,e){"use strict";var f={curWeather:{},getWeather:function(b,c,e){var f=d.defer(),g={latitude:33,longitude:151};e=e||{coords:g};""+e.coords.latitude.toFixed(0)+e.coords.longitude.toFixed(0);return a.get("http://api.openweathermap.org/data/2.5/weather?appid=227b37f61eeafe6959b97149fff86cc2&lat="+e.coords.latitude+"&lon="+e.coords.longitude+"&units="+b+"&cnt=5").then(function(a){f.resolve(a.data)},function(a){f.reject(a)}),f.promise},populateModalObjectFromResponse:function(a,c){var d=c;return f.curWeather[d]?f.curWeather[d]:(f.curWeather[d]={temp:{},clouds:null},a&&(a.main&&(f.curWeather[d].temp.current=a.main.temp,f.curWeather[d].temp.min=a.main.temp_min,f.curWeather[d].temp.max=a.main.temp_max,f.curWeather[d].humidity=a.main.humidity),a.sys&&(f.curWeather[d].countryCode=a.sys.country),a.wind&&(f.curWeather[d].windSpeed=a.wind.speed,f.curWeather[d].windDeg=a.wind.deg),f.curWeather[d].locationname=a.name,f.curWeather[d].clouds=a.clouds?a.clouds.all:void 0,f.curWeather[d].timestamp=b("date")(new Date,"dd,MMM yy hh:mm a")),f.curWeather[d])},getCurrentPosition:function(){var a=d.defer();if(c.navigator.geolocation){var b={enableHighAccuracy:!0,timeout:5e3,maximumAge:0};c.navigator.geolocation.getCurrentPosition(function(b){a.resolve(b)},function(b){a.reject(b)},b),e(function(){a.reject("Geo Location timed out")},1e4)}else a.reject("Geolocation not supported.");return a.promise}};return f}),weatherWidgetModule.filter("temparature",function(a){return function(b,c){c||(c=1);var d=a("number");return d(b,c)+"&deg;"}}),weatherWidgetModule.directive("currentWeather",function(a,b){return{restrict:"E",scope:{units:"@?",title:"@",showwind:"@?"},templateUrl:"templates/weatherWidgetDisplay.html",link:function(b,c,d){b.units=b.units,b.showwind=b.showwind||!0,b.title=b.title||"Sample Date Widget",b.weather={};var e=a.getCurrentPosition().then(a.getWeather.bind(null,b.units,b.showwind));e.then(function(c){b.weather=a.populateModalObjectFromResponse(c,b.title)})}}}),weatherWidgetModule.directive("weatherIcon",function(){return{restrict:"E",replace:!0,scope:{cloudiness:"@",customSize:"=",useGoogleImages:"="},link:function(a){a.getIconClass=function(){return a.cloudiness<20?"wi wi-day-sunny":a.cloudiness<90?"wi wi-day-cloudy":"wi wi-cloudy"}},template:"<i style='font-size:{{customSize}}px;' ng-class='getIconClass()'></i>"}}),weatherWidgetModule.directive("windIcon",function(){return{restrict:"E",replace:!0,scope:{angle:"@",customSize:"="},link:function(a){a.getWindIconClass=function(){if(a.angle)return"wi wi-wind towards-"+a.angle+"-deg"}},template:"<i style='font-size:{{customSize}}px;' ng-class='getWindIconClass()'></i>"}});